#summary Введение

* Конфигуратор ppp соединений (vpnpptp) и интерфейс управления (ponoff) для VPN через PPTP - Корбина, Корбина-Билайн и другие.

Реализация: Lazarus + FPC.

Пакеты для мандривы лежат здесь: ftp://ftp.linuxcenter.ru/pub/Mandriva/EduMandriva/educontrib и здесь http://code.google.com/p/vpnpptp/downloads/list

Пакет входит в дистрибутивы: Edumandriva LXDE ONE, российский Mandriva Power Pack, MagOS, MiniOS.

Программа представлена в версиях пакетов:

1) vpnpptp-kde-one - в этой версии нет никаких зависимостей, поэтому она работает прямо так в Mandriva One, Mandriva Free, Mandriva Power Pack, но только для KDE (или в других DE, но с самостоятельным запуском из-под root или из Центра Управления Mandriva).

2) vpnpptp-allde - в этой версии имеются дополнительные зависимости, поэтому она работает в Mandriva One, Mandriva Free, Mandriva Power Pack в любых DE, но эти зависимости могут отсутствовать в дистрибутиве, и тогда потребуется интернет, чтобы скачать их.

Авторы:

Логинов Алексей Валерьевич.

loginov_alex@inbox.ru, loginov.alex.valer@gmail.com - электронная почта.

Казанцев Александр Сергеевич.

kazancas@mandriva.ru - электронная почта.

* Описание структуры файла конфигурации /opt/vpnpptp/config конфигуратора и интерфейса управления соединениями VPN через PPTP

0) имя соединения. любое значение, требования к имени соединения как к имени файла.

1) адрес vpn-сервера. значение: ip-адрес (вида xxx.xxx.xxx.xxx, где x - любой из квадрантов - число от 0 до 255) или символьный адрес.

2) шлюз локальной сети. значение вида xxx.xxx.xxx.xxx, где x - любой из квадрантов (октетов) - число от 0 до 255.

3) сетевой интерфейс. значение вида ethN, где N - число от 0 до 9.

4) время реконнекта. значение: число от 1000 до 255000 - время в миллисекундах или значение 0 - отсутствие реконнекта.

5) время дозвона. значение: число от 5000 до 255000 - время в миллисекундах.

6) опция контроля state сетевого кабеля. может принимать значения mii-tool-yes (контролировать state) и mii-tool-no (не контролировать state).

7) опция механизма реконнекта. может принимать значение noreconnect-pptp (механизм реконнекта, не встроенный в демон pppd) и значение reconnect-pptp (механизм реконнекта, встроенный в демон pppd).

8) опция ведения логов pppd. может принимать значение pppd-log-yes (лог pppd ведется) и значение pppd-log-no (лог pppd не ведется).

9) опция получения маршрутов через DHCP. может принимать значение dhcp-route-yes (имеет место получение маршрутов через DHCP) и значение dhcp-route-no (не имеет места получение маршрутов через DHCP).

10) опция mtu. может принимать цифровое значение mtu или значение mtu-none (mtu не задано).

11) до версии программы 0.1.3: опция наличия шифрования. может принимать значение shifr-yes (имеет место шифрование) и значение shifr-no (не имеет места шифрование).

11) начиная с версии программы 0.1.3: опция наличия шифрования required. может принимать значение required-yes и значение required-no.

12) опция наличия аутентификации refuse-chap. может принимать значения rchap-yes и rchap-no.

13) опция наличия аутентификации refuse-eap. может принимать значения reap-yes и reap-no.

14) опция наличия аутентификации refuse-mschap. может принимать значения rmschap-yes и rmschap-no.

15) опция наличия шифрования stateless. может принимать значения stateless-yes и stateless-no.

16) опция наличия шифрования no40. может принимать значения no40-yes и no40-no.

17) опция наличия шифрования no56. может принимать значения no56-yes и no56-no.

18) опция добавления интерфейсов [ppp0..ppp9] в исключения файервола. может принимать значения shorewall-yes и shorewall-no.

19) опция создания ярлыка на рабочем столе. может принимать значения link-desktop-yes и link-desktop-no.

20) до версии программы 0.1.3: опция наличия шифрования require-mppe-128. может принимать значения require-mppe-128-yes и require-mppe-128-no.

20) начиная с версии программы 0.1.3: опция наличия шифрования no128. может принимать значения no128-yes и no128-no.

21) опция имени vpn-сервера или его IP. может принимать значения IPS-yes (адрес vpn-сервера задан IP) и IPS-no (адрес vpn-сервера задан именем).

22) опция программного добавления маршрута к vpn-серверу. может принимать значения routevpnauto-yes и routevpnauto-no.

23) опция проверки vpn-сервера, шлюза локальной сети и есть ли интернет. может принимать значения networktest-yes (выполнять проверки) и networktest-no (не выполнять проверки).

24) опция блокирования всплывающих сообщений. может принимать значения balloon-yes (блокировать) и balloon-no (не блокировать).

25) опция разрешения пользователям управлять подключением. может принимать значения sudo-yes (разрешить) и sudo-no (не разрешать).

26) опция разрешения пользователям конфигурировать соединение. может принимать значения sudo-configure-yes (разрешить) и sudo-configure-no (не разрешать).

27) опция автозапуска интернета при старте системы в графике. может принимать значения autostart-ponoff-yes и autostart-ponoff-no.

28) опция автозапуска интернета при старте системы демоном pppd. может принимать значения autostart-pppd-yes и autostart-pppd-no.

29) опция неизменения дефолтного шлюза. может принимать значения pppnotdefault-yes и pppnotdefault-no.

30) DNS1 до поднятия vpn. значение вида xxx.xxx.xxx.xxx, где x - любой из квадрантов (октетов) - число от 0 до 255 или none.

31) DNS2 до поднятия vpn. значение вида xxx.xxx.xxx.xxx, где x - любой из квадрантов (октетов) - число от 0 до 255 или none.

32) дополнительное DNS3 до поднятия vpn. значение вида xxx.xxx.xxx.xxx, где x - любой из квадрантов (октетов) - число от 0 до 255 или none.

33) опция программного добавления маршрута к dns-серверам. может принимать значения routednsauto-yes и routednsauto-no.

34) опция использования dns, полученных от vpn-сервера. может принимать значения usepeerdns-yes и usepeerdns-no.

35) DNS1 при поднятом vpn. значение вида xxx.xxx.xxx.xxx, где x - любой из квадрантов (октетов) - число от 0 до 255 или none.

36) DNS2 при поднятом vpn. значение вида xxx.xxx.xxx.xxx, где x - любой из квадрантов (октетов) - число от 0 до 255 или none.

37) опция наличия аутентификации refuse-pap. может принимать значения rpap-yes и rpap-no.

38) опция наличия аутентификации refuse-mschap-v2. может принимать значения rmschapv2-yes и rmschapv2-no.

39) опция типа vpn. может принимать значения pptp и l2tp.

40) опция mru. может принимать цифровое значение mru или значение mru-none (mru не задано).

Также может присутствовать опция none, показывающая, что соответствующий параметр еще не определен.

* Ссылки проекта конфигуратора и интерфейса управления соединениями VPN через PPTP

Со времени появления этого пакета некоторые проблемы были решены альтернативными методами - подробнее можно ознакомиться и уточнить непонятные вопросы на форумах:

http://unixforum.org/index.php?showtopic=89669&st=0&start=0
http://linuxforum.ru/viewtopic.php?id=147
http://forum.edumandriva.ru/forum/viewtopic.php?f=25&t=26&start=0

* История создания конфигуратора и интерфейса управления соединениями VPN через PPTP

1 апреля 2009 года Александром Казанцевым на http://unixforum.org (изначально адрес был http://linuxforum.ru) было опубликовано сообщение: "Так как мы явно не дождемся что французы добавят возможность использования VPN MS (самый у нас распространенный способ) то будем действовать сами".

Долгожданный проект был похож на первоапрельскую шутку - на тот момент юзер практически не мог выйти в интернет через VPN PPTP в GUI, так как приходилось настраивать VPN PPTP через скрипты и вручную доводить до ума файлы конфигурации и из консоли запускать сконфигурированное соединение.

Однако оказалось, что новый проект реален. И появилась первая программа, способная поднимать VPN PPTP в GUI, автором которой являлся Александр Сергеевич Казанцев.

В тестировании этой программы принял участие Алексей Валерьевич Логинов.

С выходом Mandriva 2010.0 остро оказалось, что программа требует доработки, но у разработчика (А. С. Казанцева) не было времени в течение полгода развивать проект, проект замер и практически умер. Тогда бывший тестировщик стал одним из разработчиков проекта, а впоследствии ведущим разработчиком, так как он знал алгоритм, знал язык, на котором писалась программа, знал теорию VPN PPTP. И проект ожил. Все версии программы, начиная с версии 0.0.2 (включительно), писал уже Алексей Валерьевич Логинов.

Первоначальный код претерпел колоссальные изменения, функционал программы резко был увеличен при том, что интерфейс остался дружелюбным к простому пользователю. В Mandriva это был один из немногих простых вариантов в GUI настраивать VPN PPTP, а имеющийся в GUI Mandriva туннель pptp требовал доработки.

Проект встретил потребность в нем пользователей, он прижился в массах сначала в России, но в связи с потребностью в нем и у иностранных пользователей, проект был переведен на многоязыковую поддержку.

В KDE для Mandriva была и есть программа KVpnc, однако она много весит (что критично, так как надо скачать из интернета то, что поднимет интернет, да еще и с зависимостями), у нее чрезмерно много опций, она сложна в понимании для новичков, слишком универсальна для всех видов vpn (в том числе для очень редких видов vpn) и потому для рядового пользователя непростая, к тому же ограничена лишь KDE.

Для Mandriva 2010.0 и ниже после плясок с бубном иногда удается запустить Network Manager и через него настроить VPN PPTP, что для большинства пользователей неприемлемо, так как требует углубленных знаний предметной области. В Mandriva 2010.1 и выше Network Manager для KDE научился настраивать VPN PPTP, но другие DE остались без плагина pptp к Network Manager.

Также написаны множественные скрипты, в частности, включенный в Mandriva скрипт pptp-command, а также другие скрипты - но новичкам командная строка сложна - им нужен GUI.

В Центре Управления Mandriva была и есть возможность настроить сеть через pptp, но эта возможность недоделана.

Программа vpnpptp - одна из немногих программ в Mandriva, которая легко умеет настраивать VPN по протоколу l2tp.

Программа же vpnpptp простая, графическая, дружелюбная, работает в любом DE, мало весит, зависимости либо минимальны, либо отсутствуют, по-умолчанию сама предлагает оптимальные настройки, и это при том, что ее функционал успешно конкурирует с другими аналогами - поэтому пользователи по достоинству оценили ее.

Почти одновременно с этим проектом родился проект besbashvpn, в котором разработчик предлагал программу для настройки VPN PPTP, написанную на Lazarus. Эта программа была написана для OpenSuse 11.1, и разработчик пытался выяснить как эта программа будет вести себя в других дистрибутивах, так как он использовал при написании программы универсальную инструкцию по настройке VPN PPTP для всех существующих дистрибутивов линукса. Однако, несмотря на универсальность используемой им инструкции, ему не удалось создать универсальный GUI и исполняемый файл для всех существующих дистрибутивов линукса, проблему зависимостей разрешить не удалось. Он не захотел сотрудничать с настоящим проектом vpnpptp и ни грамма внимания не уделил Мандриве - операционной системе, которой такой проект был нужнее других линуксов. Разработчик besbashvpn знал о разработке vpnpptp, но разработчик vpnpptp не знал о проекте besbashvpn - в итоге наработки проекта besbashvpn не были учтены в проекте vpnpptp. Превратив программу в испытательный полигон, проект besbashvpn был обречен. Очень сложно, но можно, написать конфигуратор сети игнорируя или в обход принятого в дистрибутиве решения. Однако, в попытке объять необъятное, причем сразу, рубя с плеча, проект besbashvpn умер через 3 месяца после своего рождения, так и оставшись программой для тестовых целей.